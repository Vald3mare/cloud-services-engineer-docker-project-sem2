# Проектная работа дисциплины «Docker-контейнеризация и хранение данных»

## Описание проекта

В рамках проекта выполнена контейнеризация веб-приложения, включающего:
- **Backend** — сервис на Go, обрабатывающий бизнес-логику и API.
- **Frontend** — клиентское приложение на Vue.js, обслуживаемое через Nginx.

Оркестрация выполнена с использованием **Docker Compose**, реализованы два окружения:
- **dev** — окружение для локальной разработки и тестирования.
- **prod** — окружение для продакшена, с усиленными настройками безопасности.

---

## Доступ к сервисам

- **Frontend (UI)** доступен на порту **3000** (`http://localhost:3000`) *Внутри контейнера слушает порт 80, снаружи вынес на 3000 порт*
- **Backend (API)**:
  - в **dev** окружении — на порту **8081** (`http://localhost:8081`)
  - в **prod** окружении — скрыт во внутренней сети, доступен только через frontend по адресу `http://localhost:3000/api`

---

## Запуск окружений

### DEV (локальная разработка)
```bash
docker compose --profile dev up -d --build
```

### Остановка DEV окружения
```bash
docker compose --profile dev down -v
```

### Запуск PROD окружения
```bash
docker compose --profile prod up -d --build
```

### Остановка PROD окружения
```
docker compose --profile prod down -v
```

## Проверка работы приложения
```
# UI снаружи
curl -I http://localhost:3000/

# API доступен только изнутри сети
docker exec -it frontend-prod wget -qO- http://backend:8081/health
```

## Оптимизация образов

Использованы multi-stage сборки:
 - backend собирается на golang:alpine, финальный образ на alpine:3.20.
 - frontend собирается на node:alpine, финальный образ на nginx:alpine.

Применены .dockerignore файлы для исключения ненужных артефактов.
Итоговые размеры образов минимальны:
 - frontend:prod 83.5MB
 - frontend:dev 85.9MB
 - backend:prod 48.4MB
 - backend:dev 48.4MB

## Оптимизация образов

Запуск сервисов под непривилегированными пользователями.
Для frontend добавлена capability NET_BIND_SERVICE, чтобы nginx мог слушать порт 80 без root.
В prod окружении:
 - включены read_only rootfs и tmpfs для временных директорий.
 - дропнуты все capabilities, кроме необходимых.
 - активирован параметр no-new-privileges:true.
 - открывается только порт frontend, backend доступен исключительно во внутренней сети.

Реализованы healthchecks для автоматической проверки состояния сервисов.
Настроены ограничения ресурсов:
 - backend: 256 MB RAM, 0.5 CPU
 - frontend: 128 MB RAM, 0.25 CPU



